># tui-csv-editor

## 概要

`tui-csv-viewer` は、CSV ファイルをターミナル上で表形式に表示・編集できる Rust 製の TUI（Text User Interface）ツールです。コマンドライン引数で CSV を指定し、矢印キーでセルを移動、`e` でセル編集、`w` で保存、`q` で終了できます。編集内容は元の CSV ファイルへ上書き保存されます。

- フレームワーク: Ratatui + Crossterm
- 特徴: シンプルな操作、ヘッダー無しの素直な表示、最小依存

このプログラムはCodex CLIで作成しました。

## 実行方法
1) ビルド

```bash
cargo build
```

2) 実行

```bash
# サンプル（同梱のテストデータを参照）
cargo run -- tests/data/sample.csv

# 任意のCSV
cargo run -- <path/to/file.csv>
```

- 実行中はターミナルが代替画面に切り替わります。終了時に自動復帰します。

## 操作方法（キーバインド）
- 矢印キー: セル移動（↑↓←→）
- `e`: 選択セルの編集開始（画面下に編集バッファを表示）
- `Enter`（編集中）: 編集内容をセルに反映して編集終了
- `Esc`（編集中）: 編集をキャンセル
- `w`: 変更内容を即時保存（元 CSV に上書き）
- `q`: 終了（未保存の変更があれば自動保存してから終了）

## 注意事項
- CSV はヘッダー有無を特別扱いせず、そのまま表示します。
- 不足セルは空文字として扱います（編集時に列が自動拡張される場合があります）。
- 保存は上書きです。バックアップが必要な場合は事前にファイルをコピーしてください。

## 既知の制限
- スクロール未対応: 画面に収まらない行・列は表示できません（将来対応予定）。
- 固定ヘッダー未対応: 先頭行を固定してのスクロールはできません。
- 列幅の自動調整は簡易: 最小幅のみで、横方向の折返しや自動最適化は行いません。
- 取り消し/やり直しなし: Undo/Redo は未実装です。
- 文字コード: 入出力は UTF-8 を想定しています。

## 保存オプション（バックアップ/アトミック保存）
現状は元ファイルへ直接上書きします。安全性を高めたい場合は以下を推奨します。
- 手動バックアップ: 実行前に `cp file.csv file.csv.bak`。
- アトミック保存（将来対応案）: 一時ファイルに書き出してから `rename` する実装（例: `file.csv.tmp` → `file.csv`）。

## キーバインドの変更方法
現在のキーバインドはコードに直書きです。変更する場合は以下を編集してください。
- 対象ファイル: `src/main.rs`
- 関数: `handle_key`
- 例（保存キーを `w` → `s` に変更）:
  - `KeyCode::Char('w')` を `KeyCode::Char('s')` に置換

設定ファイルによるカスタマイズやキーマップの外出しは将来拡張として検討できます。
